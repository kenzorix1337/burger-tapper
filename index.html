<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–≥—Ä–∞ —Å –ö–ª–∏–∫–∞–º–∏</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #ffcccb, #ffe5b4);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            color: #333;
            overflow: hidden;
        }
        #game, #top-players {
            text-align: center;
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            display: none; /* –°–∫—Ä—ã–≤–∞–µ–º —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
        }
        #score {
            font-size: 24px;
            margin-bottom: 10px;
        }
        #burger {
            width: 100px;
            height: 100px;
            background-image: url('https://your-image-url.com/image.png'); /* –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ–π URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è */
            background-size: cover;
            border-radius: 50%;
            margin: 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.1s;
        }
        #burger:hover {
            transform: scale(1.1);
        }
        .hitmarker {
            position: absolute;
            background-color: rgba(255, 0, 0, 0.7);
            color: white;
            padding: 5px;
            border-radius: 5px;
            font-size: 12px;
            animation: fade-out 1s forwards;
        }
        @keyframes fade-out {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }
        .button {
            background-color: #ff5722;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            margin-top: 10px;
        }
        .button:hover { background-color: #e64a19; }
        #top-players {
            margin-top: 20px;
            text-align: left;
            background: rgba(255, 255, 255, 0.8);
            padding: 10px;
            border-radius: 10px;
            display: none;
        }
        .player {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }
        .player-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #ff5722;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
        }
        .navigation {
            display: flex;
            justify-content: space-around;
            width: 100%;
            position: absolute;
            bottom: 20px;
        }
    </style>
</head>
<body>
    <div id="game" style="display: block;">
        <div id="score">–ö–ª–∏–∫–∏: 0</div>
        <div id="burger">üçî</div>
        <div class="navigation">
            <button class="button" id="viewProfile">–ü—Ä–æ—Ñ–∏–ª—å</button>
            <button class="button" id="topButton">–¢–æ–ø –ò–≥—Ä–æ–∫–æ–≤</button>
        </div>
    </div>

    <div id="top-players">
        <h3>–¢–æ–ø 100 –∏–≥—Ä–æ–∫–æ–≤:</h3>
        <div id="players-list"></div>
        <button class="button" id="backButton">–ù–∞–∑–∞–¥</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
        import { getFirestore, doc, setDoc, getDoc, query, orderBy, limit, getDocs, collection } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDndBcV29tFvBX-RGzCIAUVEnVy8G5GdJc",
            authDomain: "whopper-a32f7.firebaseapp.com",
            projectId: "whopper-a32f7",
            storageBucket: "whopper-a32f7.appspot.com",
            messagingSenderId: "701387895307",
            appId: "1:701387895307:web:cc656083f5f0ed1c590d0e",
            measurementId: "G-PQ6JZEZMEP"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        let userId = '–í–∞—à_–Ω–∏–∫–Ω–µ–π–º'; // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∏–∫–Ω–µ–π–º–∞
        let taps = 0;

        const burger = document.getElementById('burger');
        const score = document.getElementById('score');
        const topPlayersDiv = document.getElementById('top-players');
        const playersList = document.getElementById('players-list');
        const topButton = document.getElementById('topButton');
        const backButton = document.getElementById('backButton');

        burger.addEventListener('click', async (event) => {
            taps++;
            updateScore();
            showHitmarker(event, 1);
        });

        const updateScore = () => {
            score.innerText = `–ö–ª–∏–∫–∏: ${taps}`;
            saveToFirestore();
        };

        const showHitmarker = (event, points) => {
            const hitmarker = document.createElement('div');
            hitmarker.className = 'hitmarker';
            hitmarker.innerText = `+${points}`;
            const rect = burger.getBoundingClientRect();
            hitmarker.style.left = `${event.clientX - rect.left}px`;
            hitmarker.style.top = `${event.clientY - rect.top}px`;
            burger.appendChild(hitmarker);
            setTimeout(() => hitmarker.remove(), 1000);
        };

        const saveToFirestore = async () => {
            if (!userId) return;
            await setDoc(doc(db, 'users', userId), { taps }, { merge: true });
        };

        topButton.addEventListener('click', async () => {
            const q = query(collection(db, 'users'), orderBy('taps', 'desc'), limit(100));
            const querySnapshot = await getDocs(q);
            playersList.innerHTML = ''; // –û—á–∏—Å—Ç–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ
            querySnapshot.forEach(doc => {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'player';
                playerDiv.innerHTML = `<div class="player-icon">${doc.id.charAt(0).toUpperCase()}</div> ${doc.id}: ${doc.data().taps} –∫–ª–∏–∫–æ–≤`;
                playersList.appendChild(playerDiv);
            });
            topPlayersDiv.style.display = 'block';
            document.getElementById('game').style.display = 'none';
        });

        backButton.addEventListener('click', () => {
            topPlayersDiv.style.display = 'none';
            document.getElementById('game').style.display = 'block';
        });
    </script>
</body>
</html>
